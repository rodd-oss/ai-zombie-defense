// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: server_favorites.sql

package generated

import (
	"context"

	"ai-zombie-defense/backend-api/internal/db/types"
)

const addFavorite = `-- name: AddFavorite :exec
INSERT INTO server_favorites (player_id, server_id, note)
VALUES (?, ?, ?)
`

type AddFavoriteParams struct {
	PlayerID int64   `json:"player_id"`
	ServerID int64   `json:"server_id"`
	Note     *string `json:"note"`
}

func (q *Queries) AddFavorite(ctx context.Context, db DBTX, arg *AddFavoriteParams) error {
	_, err := db.ExecContext(ctx, addFavorite, arg.PlayerID, arg.ServerID, arg.Note)
	return err
}

const getFavorite = `-- name: GetFavorite :one
SELECT player_id, server_id, added_at, note FROM server_favorites
WHERE player_id = ? AND server_id = ?
`

type GetFavoriteParams struct {
	PlayerID int64 `json:"player_id"`
	ServerID int64 `json:"server_id"`
}

func (q *Queries) GetFavorite(ctx context.Context, db DBTX, arg *GetFavoriteParams) (*ServerFavorite, error) {
	row := db.QueryRowContext(ctx, getFavorite, arg.PlayerID, arg.ServerID)
	var i ServerFavorite
	err := row.Scan(
		&i.PlayerID,
		&i.ServerID,
		&i.AddedAt,
		&i.Note,
	)
	return &i, err
}

const listPlayerFavorites = `-- name: ListPlayerFavorites :many
SELECT s.server_id, s.ip_address, s.port, s.auth_token, s.name, s.map_rotation, s.max_players, s.current_players, s.is_online, s.last_heartbeat, s.region, s.version, s.created_at, sf.added_at, sf.note
FROM servers s
JOIN server_favorites sf ON s.server_id = sf.server_id
WHERE sf.player_id = ?
ORDER BY sf.added_at DESC
`

type ListPlayerFavoritesRow struct {
	ServerID       int64           `json:"server_id"`
	IpAddress      string          `json:"ip_address"`
	Port           int64           `json:"port"`
	AuthToken      *string         `json:"auth_token"`
	Name           string          `json:"name"`
	MapRotation    *string         `json:"map_rotation"`
	MaxPlayers     int64           `json:"max_players"`
	CurrentPlayers int64           `json:"current_players"`
	IsOnline       int64           `json:"is_online"`
	LastHeartbeat  *string         `json:"last_heartbeat"`
	Region         *string         `json:"region"`
	Version        *string         `json:"version"`
	CreatedAt      types.Timestamp `json:"created_at"`
	AddedAt        types.Timestamp `json:"added_at"`
	Note           *string         `json:"note"`
}

func (q *Queries) ListPlayerFavorites(ctx context.Context, db DBTX, playerID int64) ([]*ListPlayerFavoritesRow, error) {
	rows, err := db.QueryContext(ctx, listPlayerFavorites, playerID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	items := []*ListPlayerFavoritesRow{}
	for rows.Next() {
		var i ListPlayerFavoritesRow
		if err := rows.Scan(
			&i.ServerID,
			&i.IpAddress,
			&i.Port,
			&i.AuthToken,
			&i.Name,
			&i.MapRotation,
			&i.MaxPlayers,
			&i.CurrentPlayers,
			&i.IsOnline,
			&i.LastHeartbeat,
			&i.Region,
			&i.Version,
			&i.CreatedAt,
			&i.AddedAt,
			&i.Note,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const removeFavorite = `-- name: RemoveFavorite :exec
DELETE FROM server_favorites
WHERE player_id = ? AND server_id = ?
`

type RemoveFavoriteParams struct {
	PlayerID int64 `json:"player_id"`
	ServerID int64 `json:"server_id"`
}

func (q *Queries) RemoveFavorite(ctx context.Context, db DBTX, arg *RemoveFavoriteParams) error {
	_, err := db.ExecContext(ctx, removeFavorite, arg.PlayerID, arg.ServerID)
	return err
}
